{% extends './base.html' %}

{% block title %}CVE Details{% endblock %}

{% block content %}
<main>
    <section>
        <h2>Details for {{ cve_id }}</h2>
        {% if cve %}
            <p><strong>ID:</strong> {{ cve.id }}</p>
            <p><strong>Summary:</strong> {{ cve.summary }}</p>
            <p><strong>Published:</strong> {{ cve.Published }}</p>
            <p><strong>Modified:</strong> {{ cve.Modified }}</p>
            {% if cve.cvss %}
                <p><strong>CVSS Score:</strong> {{ cve.cvss }}</p>
            {% endif %}

        
            {% if cve.nvd_details %}
                <h2>NVD Details</h2>
                <ul>
                    {% for item in cve.nvd_details %}
                        <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No additional data available from NVD.</p>
            {% endif %}
            
            <h2>AI-Generated Analysis</h2>
            <div style="border: 1px solid #ccc; padding: 10px;">
                <p>{{ ai_generated_summary }}</p>
            </div>
        {% else %}
            <p>No details available for this CVE.</p>
        {% endif %}
        <a href="{% url 'recent_cves' %}">Back to Recent CVEs</a>
    </section>
</main>
{% endblock %}
